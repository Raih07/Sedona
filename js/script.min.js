function show_modal(e){modal_win.classList.add("open"),e.preventDefault(),storage_login&&storage_mess?(login.value=storage_login,mess.value=storage_mess,email.focus()):storage_login?(login.value=storage_login,mess.focus()):(login.focus(),mess.value=storage_mess),document.onkeydown=function(e){27===e.keyCode&&close_modal(modal_win)}}function close_modal(e){e.classList.remove("open"),e.classList.remove("modal-error")}function init(){(myMap=new ymaps.Map("YMapsID",{center:[59.939107,30.321463],zoom:17,controls:[]})).behaviors.disable("scrollZoom"),myMap.controls.add("zoomControl",{float:"none",position:{top:"100px",right:"20px"}}),myMap.controls.add("geolocationControl"),myMap.controls.add("fullscreenControl"),myMap.controls.add("routeButtonControl",{float:"right"}),myPlacemark=new ymaps.Placemark([59.938631,30.323055],{hintContent:"NЁRDS",balloonContent:"191186, Санкт-Петербург, ул. Б. Конюшенная, д. 19/8"},{iconLayout:"default#image",iconImageHref:"img/marker.png",iconImageSize:[231,190],iconImageOffset:[-48,-190]}),myMap.geoObjects.add(myPlacemark)}function Slider(e){function t(e){var t;c=y.getBoundingClientRect(),f=p.getBoundingClientRect(),r=v.getBoundingClientRect(),g=e.clientX-e.target.getBoundingClientRect().left,t=e.target.previousElementSibling?"maxElem":"minElem",document.onmousemove=function(e){s(e,t)},document.onmouseup=function(){m()}}function n(e){var t=e-g-r.left;t<0&&(t=0);var n=f.left-r.left-y.offsetWidth;t>n&&(t=n),y.style.left=t+"px",h.style.left=t+y.offsetWidth/2+"px",l("slide_min",t)}function o(e){var t=e-g-r.left,n=c.right-r.left;t<n&&(t=n);var o=v.offsetWidth-p.offsetWidth;t>o&&(t=o),p.style.left=t+"px",h.style.right=v.offsetWidth-(t+p.offsetWidth/2)+"px",l("slide_max",t)}function l(e,t){v.dispatchEvent(new CustomEvent(e,{bubbles:!0,detail:a(t)}))}function i(e){return b*e}function a(e){return Math.round(e/b)}function s(e,t){switch(t){case"minElem":n(e.clientX);break;case"maxElem":o(e.clientX)}}function m(){d()}function d(){document.onmousemove=null,document.onmouseup=null}function u(e){return e.getBoundingClientRect().left-r.left}try{new CustomEvent("IE has CustomEvent, but doesn't support constructor")}catch(e){window.CustomEvent=function(e,t){var n;return t=t||{bubbles:!1,cancelable:!1,detail:void 0},(n=document.createEvent("CustomEvent")).initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n},CustomEvent.prototype=Object.create(window.Event.prototype)}var r,c,f,g,v=e.elem,y=document.getElementById("thumb-min"),p=document.getElementById("thumb-max"),h=document.getElementById("scale-active"),E=e.max||2e4,b=(v.offsetWidth-y.offsetWidth)/E;v.ondragstart=function(){return!1},v.onmousedown=function(e){if(e.target.classList.contains("filter-thumb"))return t(e),!1},this.setMinValue=function(e){e<0&&(e=0);var t=i(e),n=u(p)-p.offsetWidth;t>n&&(t=n),y.style.left=t+"px",h.style.left=t+y.offsetWidth/2+"px",l("slide_min",t)},this.setMaxValue=function(e){e>E&&(e=E);var t=i(e),n=u(y)+y.offsetWidth;t<n&&(t=n),p.style.left=t+"px",h.style.right=v.offsetWidth-(t+p.offsetWidth/2)+"px",l("slide_max",t)}}function getChar(e){return null==e.which?e.keyCode<32?null:String.fromCharCode(e.keyCode):0!=e.which&&0!=e.charCode?e.which<32?null:String.fromCharCode(e.which):null}document.body.onkeydown=function(e){9===e.keyCode&&(document.body.classList.add("tab-user"),document.addEventListener("click",function(){document.body.classList.remove("tab-user")}))},document.removeEventListener("click",function(){document.body.classList.remove("tab-user")});var modal_win=document.getElementById("modal"),modal_btn=document.getElementById("modal_close"),btn_write_us=document.getElementById("btn_write_us"),form=modal_win.getElementsByClassName("feedback-form")[0],login=document.getElementById("feedback-form-fullname"),email=document.getElementById("feedback-form-email"),mess=document.getElementById("feedback-form-message"),storage_login=localStorage.getItem("login"),storage_mess=localStorage.getItem("mess");modal_btn.addEventListener("click",function(){close_modal(modal_win)}),btn_write_us.addEventListener("click",show_modal),form.addEventListener("submit",function(e){modal_win.classList.remove("modal-error"),""==login.value||""==email.value||""==mess.value?(setTimeout(function(){modal_win.classList.add("modal-error")},0),e.preventDefault()):(localStorage.setItem("login",login.value),localStorage.setItem("mess",mess.value))}),ymaps.ready(init);var myMap,myPlacemar,sliderElem=document.getElementById("slider"),minInput=document.getElementById("mincost"),maxInput=document.getElementById("maxcost"),slider=new Slider({elem:sliderElem,max:2e4});sliderElem.addEventListener("slide_min",function(e){minInput.value=e.detail}),sliderElem.addEventListener("slide_max",function(e){maxInput.value=e.detail}),minInput.onkeypress=maxInput.onkeypress=function(e){var t=getChar(e);if(!(e.ctrlKey||e.altKey||e.metaKey||null==t))return!(t<"0"||t>"9")&&void 0},minInput.oninput=function(){slider.setMinValue(this.value)},maxInput.oninput=function(){slider.setMaxValue(this.value)};